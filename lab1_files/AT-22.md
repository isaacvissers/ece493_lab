# Acceptance Test Suite — UC-22 Validate Review Form Fields (No Invalid Characters / No Blanks)

## Scope
Validate that CMS enforces review field validation so stored reviews are clean and complete, including:
- required fields are not blank (especially on submission),
- invalid characters are rejected,
- multiple errors are presented clearly,
- field length limits are enforced (if applicable),
- failures after validation (DB write) are handled safely,
- validation configuration failures fail safely.

Covers UC-22 extensions (3a, 3b, 3c, 2a, 5a, 3d).

## Assumptions / Notes
- “Invalid characters” are not explicitly defined; test cases use representative examples (control chars, HTML/script tags, disallowed symbols). Align with your implementation’s actual allowed set.
- Some systems allow saving drafts with blanks; these tests assume **submission** enforces required fields at minimum. Adjust draft expectations if partial drafts are allowed.
- If length limits are not implemented, skip length-related tests.

---

## Test Data
- **Reviewer account**: `reviewer1@example.com`
- **Assigned paper (accepted)**: `PAPER-090`
- Review period open; review form configured.

Representative inputs:
- **Valid text**: "Clear, concise comment."
- **Blank required field**: empty string
- **Invalid characters**: embedded control characters (e.g., `\u0000`), or markup like `<script>alert(1)</script>` (depending on rules)
- **Too long text**: string exceeding configured max length

---

# Test Cases

## AT-UC22-01 — Valid review inputs pass validation and save/submit succeeds (Happy Path)
**Objective:** Ensure clean inputs are accepted.  
**Preconditions:** Reviewer logged in; form available; assignment accepted.  
**Steps:**
1. Fill all required fields with valid values.
2. Enter valid text in comment fields.
3. Click **Save Draft** or **Submit Review**.
**Expected Results:**
- Validation passes.
- Review is stored (draft or submitted).
- Success confirmation shown.

---

## AT-UC22-02 — Blank required field blocks submission and shows errors (Extension 3a)
**Objective:** Ensure required fields cannot be blank at submission.  
**Preconditions:** Review period open.  
**Steps:**
1. Leave one required field blank.
2. Click **Submit Review**.
**Expected Results:**
- Submission blocked.
- Blank field highlighted and error summary displayed.
- No submitted review stored; status remains draft/unsubmitted.
- After filling missing field, submission succeeds.

---

## AT-UC22-03 — Invalid characters in a field block save/submit (Extension 3b)
**Objective:** Ensure invalid characters are rejected.  
**Preconditions:** Review period open.  
**Steps:**
1. Enter invalid characters into a comment field (e.g., `<script>alert(1)</script>` or a control char).
2. Click **Save Draft** (and/or **Submit Review**).
**Expected Results:**
- Action blocked (save/submit) per policy.
- Field highlighted and error explains invalid characters/rule violation.
- After removing invalid characters, action succeeds.

---

## AT-UC22-04 — Multiple validation errors are shown together (Extension 3c)
**Objective:** Ensure consolidated feedback.  
**Preconditions:** Review period open.  
**Steps:**
1. Leave a required field blank.
2. Enter invalid characters in another field.
3. Click **Submit Review**.
**Expected Results:**
- Submission blocked.
- Consolidated error summary lists all issues.
- All problematic fields highlighted.
- After correcting all errors, submission succeeds.

---

## AT-UC22-05 — Field length limit enforcement blocks action and provides guidance (Extension 2a, if applicable)
**Objective:** Ensure max length constraints are enforced.  
**Preconditions:** Known max length configured for at least one text field.  
**Steps:**
1. Paste text exceeding max length into the limited field.
2. Click **Save Draft** or **Submit Review**.
**Expected Results:**
- Action blocked.
- Message indicates maximum allowed length.
- Field highlighted.
- After shortening text to within limit, action succeeds.

---

## AT-UC22-06 — DB write failure after validation passes shows error and does not store/update (Extension 5a)
**Objective:** Ensure persistence failure is handled safely.  
**Preconditions:** Simulate DB write failure at save time.  
**Steps:**
1. Enter valid inputs so validation passes.
2. Click **Submit Review** (or **Save Draft**).
3. Force DB failure during write.
**Expected Results:**
- Error shown indicating could not save/submit at this time.
- Failure logged for admin review.
- Review is not stored/updated as submitted; draft remains unchanged.
- Reviewer can retry later.

---

## AT-UC22-07 — Validation rules unavailable blocks action and logs configuration issue (Extension 3d)
**Objective:** Fail safely when validation rules cannot be loaded.  
**Preconditions:** Simulate missing validation configuration (rules unavailable).  
**Steps:**
1. Attempt to save or submit a review.
**Expected Results:**
- System blocks save/submit.
- Message indicates action cannot be completed at this time.
- Configuration failure logged for administrator review.

---

# Exit Criteria (Definition of Done for UC-22)
UC-22 is accepted when:
- Valid inputs save/submit successfully (AT-UC22-01), and
- Blank required fields and invalid characters are blocked with actionable feedback (AT-UC22-02, AT-UC22-03), and
- Multiple errors are shown together (AT-UC22-04), and
- Length limits (if present) are enforced (AT-UC22-05), and
- DB and configuration failures fail safely with clear messaging and logging (AT-UC22-06, AT-UC22-07).
