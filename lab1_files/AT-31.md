# Acceptance Test Suite — UC-31 Register for the Conference (Authorized User)

## Scope
Validate that an authorized user can register for the conference to attend, and that CMS:
- enforces eligibility (authorized user) and registration window rules,
- collects and validates required registration information,
- handles payment flows correctly when applicable,
- prevents duplicate registrations,
- persists registration state correctly and provides confirmation,
- handles database and notification failures safely.

Covers UC-31 extensions (registration window closed, not eligible, 4a, 5a, 7a, 7b, 9a).

## Assumptions / Notes
- Payment may be optional; include payment tests only if your CMS requires fees.
- Eligibility rules for “authorized” may be role-based or invite-based; align expected outcomes with your policy.
- “Registered” status enables attendee access/permissions as configured.

---

## Test Data
- Users:
  - **Eligible authorized user**: `attendee1@example.com`
  - **Ineligible user**: `userX@example.com`
  - **Admin**: `admin1@example.com`
- Conferences:
  - `CONF-11` registration **open**
  - `CONF-12` registration **closed**
- Registration form fields (example):
  - Full name (required)
  - Affiliation (required)
  - Contact email (required, valid email)
  - Attendance type (optional)
- Payment (optional):
  - Successful payment method (test card)
  - Declined payment method (test card)
- Failure simulations:
  - DB write failure on registration save
  - Notification delivery failure

---

# Test Cases

## AT-UC31-01 — Eligible user registers successfully during open window (Happy Path)
**Objective:** Confirm successful registration and persistence.  
**Preconditions:** `CONF-11` registration open; user eligible; user logged in.  
**Steps:**
1. Log in as `attendee1@example.com`.
2. Navigate to **Conference Registration** for `CONF-11`.
3. Fill all required fields with valid values.
4. Submit registration.
**Expected Results:**
- System validates fields successfully.
- Registration is saved and status becomes **Registered**.
- Confirmation page/message displayed.
- Registration appears in user account/registration summary.

---

## AT-UC31-02 — Confirmation notification sent after successful registration (If applicable)
**Objective:** Validate confirmation delivery.  
**Preconditions:** Notifications enabled; AT-UC31-01 completed.  
**Steps:**
1. Complete registration for `CONF-11`.
2. Check in-app notifications and/or email sandbox/inbox.
**Expected Results:**
- Confirmation notification is delivered to the user.
- Message includes conference identifier/name and registration confirmation.
- No sensitive internal data is leaked.

---

## AT-UC31-03 — Registration blocked when registration window is closed (Precondition: window closed)
**Objective:** Enforce registration period rules.  
**Preconditions:** `CONF-12` registration closed; user logged in.  
**Steps:**
1. Log in as `attendee1@example.com`.
2. Navigate to **Conference Registration** for `CONF-12`.
3. Attempt to submit registration.
**Expected Results:**
- System blocks registration.
- “Registration closed” message shown (with dates if available).
- No registration record is created.

---

## AT-UC31-04 — Ineligible user cannot register (Precondition: not eligible)
**Objective:** Enforce eligibility/authorization rules.  
**Preconditions:** `userX@example.com` is not eligible to register; `CONF-11` open.  
**Steps:**
1. Log in as `userX@example.com`.
2. Attempt to access registration page and submit registration.
**Expected Results:**
- Access denied or registration blocked with eligibility message.
- No registration record is created.
- Attempt logged (if logging exists).

---

## AT-UC31-05 — Missing/invalid required fields prevent submission with actionable errors (Extension 4a)
**Objective:** Validate registration form input rules.  
**Preconditions:** `CONF-11` open; eligible user logged in.  
**Steps:**
1. Open registration form.
2. Leave required fields blank OR enter invalid email format.
3. Submit registration.
**Expected Results:**
- Submission blocked.
- Missing/invalid fields highlighted with clear messages.
- After correcting fields, user can submit successfully.

---

## AT-UC31-06 — Payment required: successful payment leads to registered status (Extension 5a, if applicable)
**Objective:** Validate successful paid registration.  
**Preconditions:** Conference requires payment; payment service available; eligible user logged in.  
**Steps:**
1. Fill registration form with valid values.
2. Proceed to payment.
3. Complete payment with a “success” test method.
**Expected Results:**
- Payment succeeds.
- Registration saved as **Registered**.
- Confirmation shown and receipt/summary available (if supported).

---

## AT-UC31-07 — Payment failure or cancellation prevents registered status (Extension 5a, if applicable)
**Objective:** Ensure failed payment does not register user.  
**Preconditions:** Conference requires payment; eligible user logged in.  
**Steps:**
1. Fill registration form.
2. Proceed to payment.
3. Use declined method or cancel payment.
**Expected Results:**
- Payment fails or is cancelled.
- User is NOT marked **Registered**.
- System shows error and allows retry.
- If supported: registration is marked **Pending Payment** (must be clearly indicated), otherwise no successful registration is recorded.

---

## AT-UC31-08 — Duplicate registration is prevented; system shows existing status (Extension 7a)
**Objective:** Prevent multiple registrations by the same user.  
**Preconditions:** User already registered for `CONF-11`.  
**Steps:**
1. Log in as registered user.
2. Attempt to register again for `CONF-11`.
**Expected Results:**
- System detects existing registration.
- Registration action is blocked.
- User sees message like “Already registered” and can view registration details.

---

## AT-UC31-09 — Database write failure prevents registration persistence and user remains unregistered (Extension 7b)
**Objective:** Ensure safe failure on persistence.  
**Preconditions:** Simulate DB failure on save; `CONF-11` open; eligible user logged in.  
**Steps:**
1. Fill valid registration form.
2. Submit registration (and complete payment if applicable) while DB failure is active.
3. Refresh or re-open registration status page.
**Expected Results:**
- System displays error: registration could not be saved.
- Failure is logged.
- User is not shown as registered after refresh (no partial success state).

---

## AT-UC31-10 — Notification failure after save does not roll back registration (Extension 9a)
**Objective:** Ensure registration remains valid if confirmation cannot be sent.  
**Preconditions:** Simulate notification service failure; `CONF-11` open; eligible user logged in.  
**Steps:**
1. Submit valid registration.
2. Force confirmation notification failure.
3. Check registration status in account/registration summary.
**Expected Results:**
- Registration remains saved as **Registered**.
- User sees confirmation in-app (page) even if notification failed.
- Notification failure is logged and may be retried.

---

# Exit Criteria (Definition of Done for UC-31)
UC-31 is accepted when:
- Eligible users can register successfully during the open window and registration is persisted (AT-UC31-01), and
- Registration window and eligibility rules are enforced (AT-UC31-03, AT-UC31-04), and
- Form validation blocks invalid submissions with actionable errors (AT-UC31-05), and
- Payment flow behaves correctly if required (AT-UC31-06, AT-UC31-07), and
- Duplicate registration is prevented (AT-UC31-08), and
- DB and notification failures are handled safely without corrupting registration state (AT-UC31-09, AT-UC31-10).
