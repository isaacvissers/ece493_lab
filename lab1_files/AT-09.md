# Acceptance Test Suite — UC-09 Upload Manuscript File Within Constraints

## Scope
Validate that an author can upload a manuscript file that satisfies CMS constraints:
- accepted file formats: **PDF, Word, LaTeX**
- maximum file size: **≤ 7MB**
and that CMS rejects invalid uploads with clear errors, handling all UC-09 extensions (4a, 5a, 6a, 6b, 3a).

## Assumptions / Notes
- File upload occurs during paper submission (new submission or draft edit).
- Exact allowed extensions may vary (e.g., `.pdf`, `.docx`, `.tex`, `.zip`); tests assume the system enforces the documented formats.
- Virus/malware scanning is not required unless implemented.

---

## Test Data
Prepare files:
- **Valid PDF (<= 7MB)**: `valid.pdf`
- **Valid Word (<= 7MB)**: `valid.docx`
- **Valid LaTeX (<= 7MB)**: `valid.tex` (or packaged format as implemented)
- **Invalid type**: `invalid.txt` (or `invalid.png`)
- **Oversize file (> 7MB)**: `oversize.pdf`

---

# Test Cases

## AT-UC09-01 — Valid PDF upload succeeds (Happy Path)
**Objective:** Ensure compliant PDF is accepted and attached.  
**Preconditions:** Author is logged in and on submission form.  
**Steps:**
1. Click **Upload Manuscript**.
2. Select `valid.pdf` (<= 7MB).
3. Confirm upload.
**Expected Results:**
- System validates file type as PDF.
- System validates file size <= 7MB.
- Upload completes successfully.
- File is attached to the submission and shown in UI.

---

## AT-UC09-02 — Valid Word upload succeeds
**Objective:** Ensure compliant Word file is accepted.  
**Preconditions:** Author logged in and on submission form.  
**Steps:**
1. Upload `valid.docx`.
**Expected Results:**
- File accepted and attached.
- No validation errors.

---

## AT-UC09-03 — Valid LaTeX upload succeeds
**Objective:** Ensure compliant LaTeX submission is accepted.  
**Preconditions:** Author logged in and on submission form.  
**Steps:**
1. Upload `valid.tex` (or the required LaTeX package format).
**Expected Results:**
- File accepted and attached.
- No validation errors.

---

## AT-UC09-04 — Invalid file type is rejected (Extension 4a)
**Objective:** Ensure non-supported formats are blocked.  
**Preconditions:** Author logged in and on submission form.  
**Steps:**
1. Attempt upload of `invalid.txt`.
**Expected Results:**
- Upload is rejected.
- Error message indicates allowed formats (PDF, Word, LaTeX).
- File is not attached to submission.

---

## AT-UC09-05 — Oversize file is rejected (Extension 5a)
**Objective:** Enforce max size constraint.  
**Preconditions:** Author logged in and on submission form.  
**Steps:**
1. Attempt upload of `oversize.pdf` (> 7MB).
**Expected Results:**
- Upload is rejected.
- Error message indicates file exceeds 7MB limit.
- File is not attached to submission.

---

## AT-UC09-06 — Upload failure allows retry (Extension 6a)
**Objective:** Ensure network/server upload failures do not attach partial files.  
**Preconditions:** Author logged in; simulate network/server upload failure.  
**Steps:**
1. Attempt upload of `valid.pdf` and force failure.
2. Verify file is not attached.
3. Retry upload successfully.
**Expected Results:**
- Failure message shown and retry option available.
- After retry succeeds, file becomes attached.
- No duplicate attachments created.

---

## AT-UC09-07 — Storage/write failure prevents attachment and logs error (Extension 6b)
**Objective:** Ensure safe failure when file cannot be stored.  
**Preconditions:** Author logged in; simulate storage/database write failure after upload.  
**Steps:**
1. Upload `valid.pdf`.
2. Force storage failure at save step.
**Expected Results:**
- System reports file could not be stored.
- File is not attached to submission.
- Failure is logged for administrator review (verify logs/monitoring event).

---

## AT-UC09-08 — Cancelling file selection does not change submission (Extension 3a)
**Objective:** Ensure cancel does not attach a file.  
**Preconditions:** Author logged in and on submission form.  
**Steps:**
1. Click **Upload Manuscript**.
2. Cancel file chooser without selecting a file.
**Expected Results:**
- No file upload occurs.
- Submission remains unchanged.
- No error message (unless required by UI design).

---

## AT-UC09-09 — Replacing an uploaded file updates attachment (recommended)
**Objective:** Verify user can replace file if system allows.  
**Preconditions:** Author logged in; `valid.pdf` already uploaded and attached.  
**Steps:**
1. Upload a different valid file (e.g., `valid.docx`).
**Expected Results (if replacement allowed):**
- New file replaces old attachment (or versioned according to system design).
- UI reflects the currently attached file.
**Note:** If replacement is not allowed, system should block and show a clear message.

---

# Exit Criteria (Definition of Done for UC-09)
UC-09 is accepted when:
- Valid PDF/Word/LaTeX uploads succeed (AT-UC09-01 to AT-UC09-03), and
- Invalid types and oversize files are rejected with clear errors (AT-UC09-04, AT-UC09-05), and
- Upload/storage failures fail safely without partial attachments (AT-UC09-06, AT-UC09-07), and
- Cancelling file selection has no side effects (AT-UC09-08).
