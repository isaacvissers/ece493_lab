# Acceptance Test Suite — UC-06 Reject Invalid Login Credentials

## Scope
Validate that when a user submits **invalid login credentials**, the CMS:
- rejects the login attempt,
- does not create an authenticated session,
- does not grant access to protected features,
- displays an appropriate error message,
and handles all UC-06 extensions (4a, 4b, 7a, 4c).

## Assumptions / Notes
- The system should avoid account enumeration; error messages should be **generic** (e.g., “Invalid username or password”).
- The SRS does not define lockout, rate limiting, CAPTCHA, or MFA; these are not required for acceptance unless implemented.
- “Username” may be an email depending on system design.

---

## Test Data
Pre-seed the CMS database with:
- **Existing username/email**: `valid.user@example.com`
- **Correct password**: `CorrectPassw0rd!`
- **Incorrect password**: `WrongPassw0rd!`

Also use:
- **Non-existent username/email**: `missing.user@example.com`

---

# Test Cases

## AT-UC06-01 — Invalid password rejects login and shows error (Extension 4b)
**Objective:** Ensure wrong password does not authenticate.  
**Preconditions:** `valid.user@example.com` exists; user is logged out.  
**Steps:**
1. Open login form.
2. Enter username `valid.user@example.com`.
3. Enter password `WrongPassw0rd!`.
4. Submit.
**Expected Results:**
- Login attempt is rejected.
- User remains unauthenticated.
- Error message indicates invalid credentials (generic).
- User stays on login page and can try again.
- No redirect to home/dashboard.

---

## AT-UC06-02 — Non-existent username rejects login and shows generic error (Extension 4a)
**Objective:** Ensure unknown username does not authenticate and does not reveal account existence.  
**Preconditions:** `missing.user@example.com` does not exist; user is logged out.  
**Steps:**
1. Open login form.
2. Enter username `missing.user@example.com`.
3. Enter any password (e.g., `WrongPassw0rd!`).
4. Submit.
**Expected Results:**
- Login attempt is rejected.
- User remains unauthenticated.
- Error message is generic (e.g., “Invalid username or password”).
- Message does **not** say “username not found” or similar.
- User stays on login page and can try again.

---

## AT-UC06-03 — Error message is generic for both “missing user” and “wrong password” (Anti-enumeration)
**Objective:** Verify the system does not leak whether a username exists.  
**Preconditions:** Same as above.  
**Steps:**
1. Attempt login with `missing.user@example.com` + any password; record displayed error text.
2. Attempt login with `valid.user@example.com` + `WrongPassw0rd!`; record displayed error text.
**Expected Results:**
- Error texts are identical or equivalently generic (no indication which field was wrong).
- No additional hints reveal user existence.

---

## AT-UC06-04 — No authenticated session is created after invalid credentials
**Objective:** Confirm the system does not authenticate user after failed login.  
**Preconditions:** Execute AT-UC06-01 or AT-UC06-02; user remains on login page.  
**Steps:**
1. Without logging in, attempt to navigate directly to a protected page (e.g., dashboard/home).
2. Refresh the browser.
**Expected Results:**
- Access is denied or redirected to login.
- No protected content is displayed.
- No session/cookie/token grants authenticated access.

---

## AT-UC06-05 — Database lookup failure denies access and shows system error (Extension 4c)
**Objective:** Ensure safe failure when authentication cannot be verified due to DB issues.  
**Preconditions:** Configure DB outage/timeout/mock failure; user is logged out.  
**Steps:**
1. Open login form.
2. Enter `valid.user@example.com` and `CorrectPassw0rd!`.
3. Submit.
**Expected Results:**
- Login is rejected (no authentication granted).
- Error message indicates login cannot be completed at this time (not “invalid credentials” if the system can distinguish).
- Failure is logged for administrator review (verify logs/monitoring event).
- User remains on login page and unauthenticated.

---

## AT-UC06-06 — Sensitive error message is replaced with generic message (Extension 7a)
**Objective:** Verify the system does not display messages like “Username not found” or “Password incorrect.”  
**Preconditions:** Use a configuration or test mode where specific messages might appear, or validate UI content directly.  
**Steps:**
1. Attempt login with a non-existent username.
2. Attempt login with an existing username and wrong password.
3. Observe any displayed error messages.
**Expected Results:**
- The displayed message is generic in both cases.
- No text reveals whether the username exists or which credential was wrong.
- If any sensitive message is detected by system validation, it is replaced with a generic one and logged (if such detection is implemented).

---

# Exit Criteria (Definition of Done for UC-06)
UC-06 is accepted when:
- AT-UC06-01, AT-UC06-02, AT-UC06-04, and AT-UC06-05 pass, and
- Error messaging does not enable account enumeration (AT-UC06-03, AT-UC06-06), and
- No invalid-credential attempt results in an authenticated session or access to protected CMS features.
