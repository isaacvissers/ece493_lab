# Use Case UC-34: Receive payment confirmation (ticket)

**Goal in Context**: An attendee receives payment confirmation (a ticket/receipt) so they have proof of registration.  
**Scope**: Conference Management System (CMS)  
**Level**: User Goal  
**Primary Actor**: Attendee  
**Secondary Actors**: Payment Gateway/Processor; CMS Database; Email/Notification Service; Ticket/Receipt Generator (PDF/HTML)  
**Trigger**: The attendee completes a successful payment for conference registration (e.g., after UC-33).

## Success End Condition
* The attendee receives a payment confirmation (ticket/receipt) and can access it later as proof of registration.

## Failed End Condition
* The attendee does not receive or cannot access confirmation due to payment not completed, persistence failure, or notification/generation errors; the system does not incorrectly claim the attendee is confirmed if payment is not recorded.

## Preconditions
* The attendee has completed payment successfully (payment approved and recorded) OR has a confirmed $0 registration.
* The system has a mechanism to generate and store a ticket/receipt (e.g., confirmation page, downloadable PDF, email).
* The attendee has an account (or a tracked checkout session) linked to the purchase.
* Notification services are configured if confirmations are delivered by email/in-app.

## Main Success Scenario
1. The attendee completes registration payment successfully.
2. The system records the payment and marks the registration/order as **Paid/Confirmed**.
3. The system generates a payment confirmation artifact (ticket/receipt) that includes key details (conference name, attendee name, ticket type, amount paid, transaction reference, date/time).
4. The system displays an on-screen confirmation page showing the ticket/receipt summary and provides a download/print option (if supported).
5. The system stores the ticket/receipt and links it to the attendee’s account.
6. The system sends a confirmation message to the attendee (email and/or in-app) containing the ticket/receipt or a link to view it.
7. The attendee accesses the ticket/receipt now or later from **My Registration / Tickets** and uses it as proof of registration.

## Extensions
* **1a**: Payment not completed (declined/cancelled/failed)  
    * **1a1**: The system does not generate a ticket/receipt.
    * **1a2**: The system shows payment failure and keeps status as unpaid/unconfirmed.
* **3a**: Ticket/receipt generation fails (template/renderer issue)  
    * **3a1**: The system displays a message that confirmation is pending or could not be generated.
    * **3a2**: The system logs the error and may retry generation.
    * **3a3**: Registration remains **Paid/Confirmed** if payment is recorded.
* **5a**: Storage/database failure after payment confirmation  
    * **5a1**: The system shows an error indicating the ticket could not be saved.
    * **5a2**: The system logs and flags the issue for reconciliation.
    * **5a3**: The system does not lose the payment record; attendee can later retrieve confirmation once repaired.
* **6a**: Notification delivery fails (email/in-app)  
    * **6a1**: The ticket remains available in CMS under the attendee account.
    * **6a2**: The system logs the delivery failure and may retry later.
* **7a**: Attendee tries to retrieve ticket without authentication (for protected tickets)  
    * **7a1**: The system prompts login.
    * **7a2**: After login, the system displays the ticket/receipt.
* **7b**: Duplicate confirmation requests (user refreshes page/retries)  
    * **7b1**: The system does not create duplicate tickets for the same transaction.
    * **7b2**: The system shows the existing ticket/receipt.

## Related Information
* **Priority**: High  
* **Frequency**: Medium–High (per paid registration)  
* **Open Issues**:  
  * Ticket format (PDF vs HTML vs email-only) is not specified.  
  * Whether QR codes or check-in scanning are required is not specified.  
  * Whether confirmations are sent to all co-registrants or only payer is not specified.
