# Acceptance Test Suite — UC-12 Save Submission Progress (Draft)

## Scope
Validate that an author can save submission progress at any step and later resume work without losing changes. Ensure CMS:
- saves draft state (partial metadata and optional file attachment),
- confirms save (or provides alternate confirmation),
- preserves previously saved draft state on failures,
- supports reopening drafts reliably,
including UC-12 extensions (3a, 5a, 2a, 6a, 7a).

## Assumptions / Notes
- Draft saving is more permissive than final submission validation (i.e., incomplete/invalid fields may be allowed in draft).
- Auto-save is not required unless implemented.
- If file upload is handled separately, draft saving should still reference the attached file consistently.

---

## Test Data
- Author account: `draft.author@example.com`
- Example partial metadata: author names only, abstract draft text, partial keywords, etc.
- Optional file: `valid.pdf` (<= 7MB)

---

# Test Cases

## AT-UC12-01 — Author can save a draft at any point (Happy Path)
**Objective:** Verify saving works with partial progress.  
**Preconditions:** Author is logged in and on submission form.  
**Steps:**
1. Enter some metadata (e.g., author names and abstract) but leave other required final fields blank.
2. Click **Save Draft**.
**Expected Results:**
- System saves current submission state as a draft.
- Confirmation is displayed (or “Last saved” indicator updates).
- Draft appears in the author’s drafts list (if implemented).

---

## AT-UC12-02 — Reopening a saved draft restores the latest saved state (Happy Path continuation)
**Objective:** Ensure persistence and restore correctness.  
**Preconditions:** A draft has been saved (AT-UC12-01).  
**Steps:**
1. Navigate away from the submission form.
2. Open drafts list and select the saved draft (or reopen via link).
**Expected Results:**
- Draft loads successfully.
- Previously entered values are present exactly as saved.
- Author can continue editing.

---

## AT-UC12-03 — Multiple saves update the same draft state (Version update behavior)
**Objective:** Ensure subsequent saves persist newer changes.  
**Preconditions:** Draft exists and is open.  
**Steps:**
1. Modify some fields (e.g., update abstract text, add keywords).
2. Click **Save Draft** again.
3. Reopen draft.
**Expected Results:**
- Latest changes are present after reopening.
- System did not revert to an older state.
- No unintended duplicate drafts created (unless versioning is intended).

---

## AT-UC12-04 — Draft saving allows incomplete/invalid final fields (Extension 3a)
**Objective:** Confirm draft saving is permissive.  
**Preconditions:** Author is logged in.  
**Steps:**
1. Enter a partially invalid value (e.g., partially typed email `alice@`) or leave required final fields blank.
2. Click **Save Draft**.
**Expected Results:**
- Draft is saved successfully.
- System may show a warning about incomplete fields for final submission, but does not block saving.
- Draft is recoverable and editable later.

---

## AT-UC12-05 — Draft saving persists file attachment if uploaded (File + draft)
**Objective:** Ensure attached manuscript file is retained in the draft state.  
**Preconditions:** Author logged in; `valid.pdf` available.  
**Steps:**
1. Upload `valid.pdf` on the submission form.
2. Click **Save Draft**.
3. Reopen the draft.
**Expected Results:**
- Uploaded file remains attached/linked to the draft.
- UI indicates the attached file (filename or link).
- No duplicate attachments created unintentionally.

---

## AT-UC12-06 — Database/storage failure does not overwrite previous draft (Extension 5a)
**Objective:** Ensure safe failure and no loss of last good save.  
**Preconditions:** Draft already saved successfully; simulate DB/storage write failure.  
**Steps:**
1. Make changes to draft fields.
2. Click **Save Draft** while failure is active.
3. Reopen the draft after failure.
**Expected Results:**
- System shows error indicating draft could not be saved.
- Failure is logged for administrator review.
- Draft still contains the last successfully saved state (not partially overwritten).
- Changes from the failed save are not committed.

---

## AT-UC12-07 — Session expired redirects to login; author can retry saving (Extension 2a)
**Objective:** Ensure authentication is enforced for saving drafts.  
**Preconditions:** Author session expires (logged out) while on submission form.  
**Steps:**
1. Attempt to click **Save Draft** with expired session.
2. Log in when redirected.
3. Retry **Save Draft**.
**Expected Results:**
- System redirects to login when session is invalid.
- After login, author returns to submission form.
- Draft save succeeds when retried.

---

## AT-UC12-08 — If confirmation message fails, alternate confirmation exists (Extension 6a)
**Objective:** Ensure user can tell draft was saved even if UI toast fails.  
**Preconditions:** Simulate UI notification failure; backend save still functional.  
**Steps:**
1. Click **Save Draft**.
2. Observe UI response.
**Expected Results:**
- Draft is saved successfully.
- If toast/confirmation is missing, system shows alternate evidence (e.g., “Last saved at” timestamp updates).
- Reopening draft shows the saved changes.

---

## AT-UC12-09 — Draft retrieval failure shows error and prevents editing (Extension 7a)
**Objective:** Ensure robust handling of load failures.  
**Preconditions:** A draft exists; simulate draft retrieval failure (DB outage).  
**Steps:**
1. Attempt to open the draft.
**Expected Results:**
- System displays error indicating draft cannot be loaded at this time.
- System logs the failure for administrator review.
- Author is prevented from editing until retrieval succeeds (no stale/partial data shown as “current”).

---

# Exit Criteria (Definition of Done for UC-12)
UC-12 is accepted when:
- Drafts can be saved at any point and reopened with the latest saved state (AT-UC12-01 to AT-UC12-03), and
- Draft saving is permissive enough to preserve partial progress (AT-UC12-04), and
- File attachments persist appropriately when saved in drafts (AT-UC12-05), and
- Failures do not destroy prior saved work and are reported/logged (AT-UC12-06, AT-UC12-09), and
- Authentication and confirmation behavior match intended UX (AT-UC12-07, AT-UC12-08).
